3,14c3,12
<    varDec(list2,
<     seqExp(
<      expList(
<       assignExp(
<        simpleVar(?U?tU),
<        callExp(getchar,
<         expList())),
<       expList(
<        callExp(readlist,
<         expList()),
<        expList()))),
<     TRUE),
---
>    typeDec(
>     nameAndTyList(
>      nameAndTy(any,
>       recordTy(
>        fieldList(
>         field(any,
>          int,
>          TRUE),
>         fieldList()))),
>      nameAndTyList())),
16,17c14,15
<     varDec(list1,
<      callExp(readlist,
---
>     varDec(buffer,
>      callExp(getchar,
23c21
<        fundec(printlist,
---
>        fundec(readint,
25,26c23,24
<          field(l,
<           list,
---
>          field(any,
>           any,
29,55c27,31
<         iffExp(
<          opExp(
<           EQUAL,
<           varExp(
<            simpleVar(?U?tU)),
<           nilExp()),
<          callExp(print,
<           expList()),
<          seqExp(
<           expList(
<            callExp(printint,
<             expList()),
<            expList(
<             callExp(print,
<              expList()),
<             expList(
<              callExp(printlist,
<               expList()),
<              expList())))))),
<        fundecList())),
<      decList(
<       functionDec(
<        fundecList(
<         fundec(printint,
<          fieldList(
<           field(i,
<            int,
---
>         int,
>         letExp(
>          decList(
>           varDec(i,
>            intExp(0),
57,58d32
<           fieldList()),
<          letExp(
62c36
<              fundec(f,
---
>              fundec(isdigit,
64,65c38,39
<                field(i,
<                 int,
---
>                field(s,
>                 string,
67a42
>               int,
70,77c45,46
<                 GREAT,
<                 varExp(
<                  simpleVar(?U?tU)),
<                 intExp(0)),
<                seqExp(
<                 expList(
<                  callExp(f,
<                   expList()),
---
>                 GREATEQ,
>                 callExp(ord,
79,80c48,53
<                   callExp(print,
<                    expList()),
---
>                   varExp(
>                    simpleVar(buffer)),
>                   expList())),
>                 callExp(ord,
>                  expList(
>                   stringExp(0),
82,85c55,93
<                voidExp())),
<              fundecList())),
<            decList()),
<           seqExp(
---
>                opExp(
>                 LESSEQ,
>                 callExp(ord,
>                  expList(
>                   varExp(
>                    simpleVar(buffer)),
>                   expList())),
>                 callExp(ord,
>                  expList(
>                   stringExp(9),
>                   expList()))),
>                intExp(0))),
>              fundecList(
>               fundec(skipto,
>                fieldList(),
>                whileExp(
>                 iffExp(
>                  opExp(
>                   EQUAL,
>                   varExp(
>                    simpleVar(buffer)),
>                   stringExp( )),
>                  intExp(1),
>                  opExp(
>                   EQUAL,
>                   varExp(
>                    simpleVar(buffer)),
>                   stringExp(
> ))),
>                 assignExp(
>                  simpleVar(buffer),
>                  callExp(getchar,
>                   expList())))),
>               fundecList()))),
>            decList())),
>          seqExp(
>           expList(
>            callExp(skipto,
>             expList()),
87,93c95,99
<             iffExp(
<              opExp(
<               LESSTHAN,
<               varExp(
<                simpleVar(?U?tU)),
<               intExp(0)),
<              seqExp(
---
>             assignExp(
>              fieldVar(
>               simpleVar(any),
>               any),
>              callExp(isdigit,
95,103d100
<                callExp(print,
<                 expList()),
<                expList(
<                 callExp(f,
<                  expList()),
<                 expList()))),
<              iffExp(
<               opExp(
<                GREAT,
105,109c102
<                 simpleVar(?U?tU)),
<                intExp(0)),
<               callExp(f,
<                expList()),
<               callExp(print,
---
>                 simpleVar(buffer)),
111,116c104,148
<             expList())))),
<         fundecList())),
<       decList(
<        functionDec(
<         fundecList(
<          fundec(merge,
---
>             expList(
>              whileExp(
>               callExp(isdigit,
>                expList(
>                 varExp(
>                  simpleVar(buffer)),
>                 expList())),
>               seqExp(
>                expList(
>                 assignExp(
>                  simpleVar(i),
>                  opExp(
>                   MINUS,
>                   opExp(
>                    PLUS,
>                    opExp(
>                     TIMES,
>                     varExp(
>                      simpleVar(i)),
>                     intExp(10)),
>                    callExp(ord,
>                     expList(
>                      varExp(
>                       simpleVar(buffer)),
>                      expList()))),
>                   callExp(ord,
>                    expList(
>                     stringExp(0),
>                     expList())))),
>                 expList(
>                  assignExp(
>                   simpleVar(buffer),
>                   callExp(getchar,
>                    expList())),
>                  expList())))),
>              expList(
>               varExp(
>                simpleVar(i)),
>               expList()))))))),
>        fundecList())),
>      decList(
>       typeDec(
>        nameAndTyList(
>         nameAndTy(list,
>          recordTy(
118,119c150,151
<            field(a,
<             list,
---
>            field(first,
>             int,
122c154
<             field(b,
---
>             field(rest,
125c157,163
<             fieldList())),
---
>             fieldList())))),
>         nameAndTyList())),
>       decList(
>        functionDec(
>         fundecList(
>          fundec(readlist,
>           fieldList(),
127,134c165,213
<           iffExp(
<            opExp(
<             EQUAL,
<             varExp(
<              simpleVar(?U?tU)),
<             nilExp()),
<            varExp(
<             simpleVar(?U?tU)),
---
>           letExp(
>            decList(
>             varDec(any,
>              recordExp(any,
>               efieldList(
>                efield(any,
>                 intExp(0)),
>                efieldList())),
>              TRUE),
>             decList(
>              varDec(i,
>               callExp(readint,
>                expList(
>                 varExp(
>                  simpleVar(any)),
>                 expList())),
>               TRUE),
>              decList())),
>            seqExp(
>             expList(
>              iffExp(
>               varExp(
>                fieldVar(
>                 simpleVar(any),
>                 any)),
>               recordExp(list,
>                efieldList(
>                 efield(first,
>                  varExp(
>                   simpleVar(i))),
>                 efieldList(
>                  efield(rest,
>                   callExp(readlist,
>                    expList())),
>                  efieldList()))),
>               nilExp()),
>              expList())))),
>          fundecList(
>           fundec(merge,
>            fieldList(
>             field(a,
>              list,
>              TRUE),
>             fieldList(
>              field(b,
>               list,
>               TRUE),
>              fieldList())),
>            list,
139c218
<               simpleVar(?U?tU)),
---
>               simpleVar(a)),
142c221
<              simpleVar(?U?tU)),
---
>              simpleVar(b)),
145,149c224
<               LESSTHAN,
<               varExp(
<                fieldVar(
<                 simpleVar(?U?tU),
<                 first)),
---
>               EQUAL,
151,160c226,241
<                fieldVar(
<                 simpleVar(?U?tU),
<                 first))),
<              recordExp(list,
<               efieldList(
<                efield(first,
<                 varExp(
<                  fieldVar(
<                   simpleVar(?U?tU),
<                   first))),
---
>                simpleVar(b)),
>               nilExp()),
>              varExp(
>               simpleVar(a)),
>              iffExp(
>               opExp(
>                LESSTHAN,
>                varExp(
>                 fieldVar(
>                  simpleVar(a),
>                  first)),
>                varExp(
>                 fieldVar(
>                  simpleVar(b),
>                  first))),
>               recordExp(list,
162,172c243,261
<                 efield(rest,
<                  callExp(merge,
<                   expList())),
<                 efieldList()))),
<              recordExp(list,
<               efieldList(
<                efield(first,
<                 varExp(
<                  fieldVar(
<                   simpleVar(?U?tU),
<                   first))),
---
>                 efield(first,
>                  varExp(
>                   fieldVar(
>                    simpleVar(a),
>                    first))),
>                 efieldList(
>                  efield(rest,
>                   callExp(merge,
>                    expList(
>                     varExp(
>                      fieldVar(
>                       simpleVar(a),
>                       rest)),
>                     expList(
>                      varExp(
>                       simpleVar(b)),
>                      expList())))),
>                  efieldList()))),
>               recordExp(list,
174,189c263,285
<                 efield(rest,
<                  callExp(merge,
<                   expList())),
<                 efieldList()))))))),
<          fundecList())),
<        decList(
<         functionDec(
<          fundecList(
<           fundec(readlist,
<            fieldList(),
<            list,
<            letExp(
<             decList(
<              varDec(i,
<               callExp(readint,
<                expList()),
---
>                 efield(first,
>                  varExp(
>                   fieldVar(
>                    simpleVar(b),
>                    first))),
>                 efieldList(
>                  efield(rest,
>                   callExp(merge,
>                    expList(
>                     varExp(
>                      simpleVar(a)),
>                     expList(
>                      varExp(
>                       fieldVar(
>                        simpleVar(b),
>                        rest)),
>                      expList())))),
>                  efieldList()))))))),
>           fundecList(
>            fundec(printint,
>             fieldList(
>              field(i,
>               int,
190a287,288
>              fieldList()),
>             letExp(
192,214c290,354
<               varDec(any,
<                recordExp(any,
<                 efieldList(
<                  efield(any,
<                   intExp(0)),
<                  efieldList())),
<                TRUE),
<               decList())),
<             seqExp(
<              expList(
<               iffExp(
<                varExp(
<                 fieldVar(
<                  simpleVar(?U?tU),
<                  any)),
<                recordExp(list,
<                 efieldList(
<                  efield(first,
<                   varExp(
<                    simpleVar(?U?tU))),
<                  efieldList(
<                   efield(rest,
<                    callExp(readlist,
---
>               functionDec(
>                fundecList(
>                 fundec(f,
>                  fieldList(
>                   field(i,
>                    int,
>                    TRUE),
>                   fieldList()),
>                  iffExp(
>                   opExp(
>                    GREAT,
>                    varExp(
>                     simpleVar(i)),
>                    intExp(0)),
>                   seqExp(
>                    expList(
>                     callExp(f,
>                      expList(
>                       opExp(
>                        DIVIDE,
>                        varExp(
>                         simpleVar(i)),
>                        intExp(10)),
>                       expList())),
>                     expList(
>                      callExp(print,
>                       expList(
>                        callExp(chr,
>                         expList(
>                          opExp(
>                           PLUS,
>                           opExp(
>                            MINUS,
>                            varExp(
>                             simpleVar(i)),
>                            opExp(
>                             TIMES,
>                             opExp(
>                              DIVIDE,
>                              varExp(
>                               simpleVar(i)),
>                              intExp(10)),
>                             intExp(10))),
>                           callExp(ord,
>                            expList(
>                             stringExp(0),
>                             expList()))),
>                          expList())),
>                        expList())),
>                      expList()))))),
>                 fundecList())),
>               decList()),
>              seqExp(
>               expList(
>                iffExp(
>                 opExp(
>                  LESSTHAN,
>                  varExp(
>                   simpleVar(i)),
>                  intExp(0)),
>                 seqExp(
>                  expList(
>                   callExp(print,
>                    expList(
>                     stringExp(-),
216,236c356,381
<                   efieldList()))),
<                nilExp()),
<               expList())))),
<           fundecList())),
<         decList(
<          typeDec(
<           nameAndTyList(
<            nameAndTy(list,
<             recordTy(
<              fieldList(
<               field(first,
<                int,
<                TRUE),
<               fieldList(
<                field(rest,
<                 list,
<                 TRUE),
<                fieldList())))),
<            nameAndTyList())),
<          decList(
<           functionDec(
---
>                   expList(
>                    callExp(f,
>                     expList(
>                      opExp(
>                       MINUS,
>                       intExp(0),
>                       varExp(
>                        simpleVar(i))),
>                      expList())),
>                    expList()))),
>                 iffExp(
>                  opExp(
>                   GREAT,
>                   varExp(
>                    simpleVar(i)),
>                   intExp(0)),
>                  callExp(f,
>                   expList(
>                    varExp(
>                     simpleVar(i)),
>                    expList())),
>                  callExp(print,
>                   expList(
>                    stringExp(0),
>                    expList())))),
>                expList())))),
238c383
<             fundec(readint,
---
>             fundec(printlist,
240,241c385,386
<               field(any,
<                any,
---
>               field(l,
>                list,
244,300c389,399
<              int,
<              letExp(
<               decList(
<                functionDec(
<                 fundecList(
<                  fundec(skipto,
<                   fieldList(),
<                   whileExp(
<                    opExp(
<                     EQUAL,
<                     opExp(
<                      EQUAL,
<                      varExp(
<                       simpleVar(?U?tU)),
<                      iffExp(
<                       stringExp( ),
<                       stringExp( ),
<                       varExp(
<                        simpleVar(?U?tU)))),
<                     stringExp(
< )),
<                    assignExp(
<                     simpleVar(?U?tU),
<                     callExp(getchar,
<                      expList())))),
<                  fundecList())),
<                decList(
<                 functionDec(
<                  fundecList(
<                   fundec(isdigit,
<                    fieldList(
<                     field(s,
<                      string,
<                      TRUE),
<                     fieldList()),
<                    int,
<                    opExp(
<                     LESSEQ,
<                     opExp(
<                      GREATEQ,
<                      callExp(ord,
<                       expList()),
<                      iffExp(
<                       callExp(ord,
<                        expList()),
<                       callExp(ord,
<                        expList()),
<                       callExp(ord,
<                        expList()))),
<                     callExp(ord,
<                      expList()))),
<                   fundecList())),
<                 decList(
<                  varDec(i,
<                   intExp(0),
<                   TRUE),
<                  decList()))),
---
>              iffExp(
>               opExp(
>                EQUAL,
>                varExp(
>                 simpleVar(l)),
>                nilExp()),
>               callExp(print,
>                expList(
>                 stringExp(
> ),
>                 expList())),
303,304c402,408
<                 callExp(skipto,
<                  expList()),
---
>                 callExp(printint,
>                  expList(
>                   varExp(
>                    fieldVar(
>                     simpleVar(l),
>                     first)),
>                   expList())),
306,310c410,412
<                  assignExp(
<                   fieldVar(
<                    simpleVar(?U?tU),
<                    any),
<                   callExp(isdigit,
---
>                  callExp(print,
>                   expList(
>                    stringExp( ),
313,360c415,442
<                   whileExp(
<                    callExp(isdigit,
<                     expList()),
<                    seqExp(
<                     expList(
<                      assignExp(
<                       simpleVar(?U?tU),
<                       opExp(
<                        MINUS,
<                        opExp(
<                         PLUS,
<                         opExp(
<                          TIMES,
<                          varExp(
<                           simpleVar(?U?tU)),
<                          intExp(10)),
<                         callExp(ord,
<                          expList())),
<                        callExp(ord,
<                         expList()))),
<                      expList(
<                       assignExp(
<                        simpleVar(?U?tU),
<                        callExp(getchar,
<                         expList())),
<                       expList())))),
<                   expList(
<                    varExp(
<                     simpleVar(?U?tU)),
<                    expList()))))))),
<             fundecList())),
<           decList(
<            varDec(buffer,
<             callExp(getchar,
<              expList()),
<             TRUE),
<            decList(
<             typeDec(
<              nameAndTyList(
<               nameAndTy(any,
<                recordTy(
<                 fieldList(
<                  field(any,
<                   int,
<                   TRUE),
<                  fieldList()))),
<               nameAndTyList())),
<             decList())))))))))),
---
>                   callExp(printlist,
>                    expList(
>                     varExp(
>                      fieldVar(
>                       simpleVar(l),
>                       rest)),
>                     expList())),
>                   expList())))))),
>             fundecList()))))),
>        decList(
>         varDec(list1,
>          callExp(readlist,
>           expList()),
>          TRUE),
>         decList(
>          varDec(list2,
>           seqExp(
>            expList(
>             assignExp(
>              simpleVar(buffer),
>              callExp(getchar,
>               expList())),
>             expList(
>              callExp(readlist,
>               expList()),
>              expList()))),
>           TRUE),
>          decList()))))))),
364c446,455
<      expList()),
---
>      expList(
>       callExp(merge,
>        expList(
>         varExp(
>          simpleVar(list1)),
>         expList(
>          varExp(
>           simpleVar(list2)),
>          expList()))),
>       expList())),