# Oct 31 Thu

## SE-227::CSE

### Consistency

你要求什么样的 Consistency？

是类似于 DNS 一样的「只要在一定时间之后可以保持一致」，还是严格地一呼百应式 Consistency？

这两者的性能开销区别是很大的。当然应用场景也是大不相同的。

### All or Nothing

「要么全都有要么全完蛋」

A/N 是指一件事情要么做完了，要么无效果；不允许出现一件做了一半的事情。

### Before and After

B/A 指的是一件事情完成的先后顺序必须一定。

例如，制定了 B/A 的 T~1~ 和 T~2~ 允许出现三种情况：

*   T~1~、T~2~ 都没完成
*   T~1~ 完成了，T~2~ 没完成
*   T~1~、T~2~ 都完成了

只要不是 T~2~ 完成了且 T~1~ 没完成，就都是可以接受的情况。

B/A 并没有硬性规定说你一定要保持操作的 Atomic，加一把大锁。只要可以保证 B/A 就好了。

### Commit Point

Commit Point，意即对一个 Transaction 来讲，Commit 的时机。

什么时候 Commit，也就是说什么时候声明「我这个 Transaction 完成了，即使没完成也是可恢复的了」？

当我们利用到 Replica 的时候（看书，那个 old => bad => new），在第四步 old => bad 的一瞬间就可以提交 Commit 了。因为在这一步之后就可以确保我们的 new 数据已经生效了。即使后面任何一步突然断电也可以恢复了。

这时候就可以 Commit 了。

