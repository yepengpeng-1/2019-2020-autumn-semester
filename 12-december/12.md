# Dec 12 Thu

## SE-344::CG

### 光照的计算

光照计算，有什么意义吗？

真实的世界里，光线是可以藉由整个世界的物体反射、晕染，等等。

如果我们的光不能产生反射，就无法真实地模拟出真实世界的复杂光线条件。

### 光的种类

#### 环境光

何为环境光？

是指在每个方面上的反射光线为常数，而与观察方向无关。

#### 漫反射光

强度公式：$I = kI_t\cos \theta$。

这就是说漫反射光的强度根观察角度跟入射角度的夹角有关。

#### 镜面反射（Phong 模型）

镜面反射下的光滑物体的大部分发射光都仅仅反射到了某一个观察方向，而仅有少部分到了其他方向上。这个唤作镜面反射。

>   理想的镜面反射是会将所有的光线都按照反射定律反射出去，而完全不产生散射的。
>
>   然而实际上并不存在完美光滑的表面，因此这样的镜面反射也是不存在的。

Phong 模型说：反射的光线会被限定在一个光锥里，光锥整体指向理想反射的方向。

越光滑的表面，光锥半径越小，反射光线越集中；越粗糙的表面，光锥半径越大，反射光线越松散。

$I_{spec} = I(\theta) \cos(n\phi)$

#### 菲涅尔现象

在接近 90 度时，反射光强度会突然增大。

（想象直视太阳的感觉。）

有一些优秀的反射模型会考虑这种情形。

#### 多个光源

多个光源出现的情况下，每个点的光线强度是每个光线强度分量的矢量加和。

### 光的衰减

最简单的衰减函数：一个二次多项式的倒数。

据说这样的衰减函数效果已经很好。

经过的光程越多，衰减越大。

>   物理原理：在大气之中，经过的距离越长，空气中微尘造成的耗散越多。

### 透明度

考虑一个透明的物体。

我们利用一个「透明度」$\alpha$ 来衡量一个物体对光线的透射程度——介于 $[0, 1]$ 之间的值。

利用 $\alpha$ 来将入射光分为两部分：一部分投射、一部分反射。两部分分别进行光线运算。

### 阴影

光的遮挡造成了阴影。阴影跟物体的形状、光源的方向都有关系。

但是，假如在某一个场景中，物体和光源都是静止的，那么我们实际上可以预先渲染出「阴影」这个物体，到时候直接贴上去就好了。这样能省下很多运算。

### 繪製陰影

#### 粗暴法

恒定光强度敏感处理。超级快

一个多边形上的点都用相同的光强度来绘制。

基于下面的假设：

*   物体是一个多面体
*   光源离物体足够远，使得物体表面各处对该光线的衰减程度几乎类似
*   视点离物体足够远，使得  V × R 对于物体表面各点几乎类似

在这几条不满足的情况下，就拆分多面体成多个多边形，事情就简单了。

为了将一整个多边形压平成一个平面，我们计算一个多边形的平均法矢量来作为「压平」后平面的法矢量。

#### 马赫带效应（Mach-band Effect）

表面上的高光有时候会出现异常的情况；现行光线差值会造成表面过亮或过暗的条纹。

这是人类视觉的错觉。